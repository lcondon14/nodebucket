{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nexport let SigninComponent = class SigninComponent {\n  constructor(route, router, cookieService, securityService, fb) {\n    this.route = route;\n    this.router = router;\n    this.cookieService = cookieService;\n    this.securityService = securityService;\n    this.fb = fb;\n    this.isLoading = false;\n    this.signinForm = this.fb.group({\n      empId: [null, Validators.compose([Validators.required, Validators.pattern('^[0-9]*$')])]\n    });\n    this.sessionUser = {};\n    this.errorMessage = '';\n  }\n  signin() {\n    this.isLoading = true;\n    console.log(\"signinForm\", this.signinForm.value);\n    const empId = this.signinForm.controls['empId'].value;\n    if (!empId || isNaN(parseInt(empId, 10))) {\n      this.errorMessage = 'The employee ID is invalid. Please enter a number.';\n      this.isLoading = false;\n      return;\n    }\n    this.securityService.findEmployeeById(empId).subscribe({\n      next: employee => {\n        console.log('employee', employee);\n        this.sessionUser = employee;\n        this.cookieService.set('session_user', empId, 1);\n        this.cookieService.set('session_name', `${employee.firstName} ${employee.lastName}`, 1);\n        const returnUrl = this.route.snapshot.queryParamMap.get('returnUrl') || '/';\n        this.isLoading = false;\n        this.router.navigate([returnUrl]);\n      },\n      error: err => {\n        this.isLoading = false;\n        if (err.error.message) {\n          this.errorMessage = err.error.message;\n          return;\n        }\n        this.errorMessage = err.message;\n      }\n    });\n  }\n};\nSigninComponent = __decorate([Component({\n  selector: 'app-signin',\n  templateUrl: './signin.component.html',\n  styleUrls: ['./signin.component.css']\n})], SigninComponent);","map":{"version":3,"names":["Component","Validators","SigninComponent","constructor","route","router","cookieService","securityService","fb","isLoading","signinForm","group","empId","compose","required","pattern","sessionUser","errorMessage","signin","console","log","value","controls","isNaN","parseInt","findEmployeeById","subscribe","next","employee","set","firstName","lastName","returnUrl","snapshot","queryParamMap","get","navigate","error","err","message","__decorate","selector","templateUrl","styleUrls"],"sources":["/Users/laurelcondon/Desktop/buwebdev/nodebucket/src/app/security/signin/signin.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { CookieService } from 'ngx-cookie-service';\nimport { SecurityService } from '../security.service';\n\nexport interface SessionUser {\n  empId: number;\n  firstName: string;\n  lastName: string;\n}\n\n@Component({\n  selector: 'app-signin',\n  templateUrl: './signin.component.html',\n  styleUrls: ['./signin.component.css']\n})\nexport class SigninComponent {\n  errorMessage: string;\n  sessionUser: SessionUser;\n  isLoading: boolean = false;\n\n  signinForm = this.fb.group({\n    empId: [null, Validators.compose([Validators.required, Validators.pattern('^[0-9]*$')])]\n  });\n\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private cookieService: CookieService,\n    private securityService: SecurityService,\n    private fb: FormBuilder\n  ) {\n    this.sessionUser = {} as SessionUser;\n    this.errorMessage = '';\n  }\n\n  signin() {\n    this.isLoading = true;\n    console.log(\"signinForm\", this.signinForm.value);\n    const empId = this.signinForm.controls['empId'].value;\n\n    if (!empId || isNaN(parseInt(empId, 10))) {\n      this.errorMessage = 'The employee ID is invalid. Please enter a number.';\n      this.isLoading = false;\n      return;\n    }\n\n    this.securityService.findEmployeeById(empId).subscribe({\n      next: (employee: any) => {\n        console.log('employee', employee);\n\n        this.sessionUser = employee;\n        this.cookieService.set('session_user', empId, 1);\n        this.cookieService.set('session_name', `${employee.firstName} ${employee.lastName}`, 1);\n\n        const returnUrl = this.route.snapshot.queryParamMap.get('returnUrl') || '/';\n\n        this.isLoading = false;\n\n        this.router.navigate([returnUrl]);\n      },\n\n      error: (err) => {\n        this.isLoading = false;\n\n        if (err.error.message) {\n          this.errorMessage = err.error.message;\n          return;\n        }\n        this.errorMessage = err.message;\n      }\n    });\n  }\n}\n\n"],"mappings":";AAAA,SAASA,SAAS,QAAQ,eAAe;AACzC,SAAsBC,UAAU,QAAQ,gBAAgB;AAgBjD,WAAMC,eAAe,GAArB,MAAMA,eAAe;EAS1BC,YACUC,KAAqB,EACrBC,MAAc,EACdC,aAA4B,EAC5BC,eAAgC,EAChCC,EAAe;IAJf,KAAAJ,KAAK,GAALA,KAAK;IACL,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,aAAa,GAAbA,aAAa;IACb,KAAAC,eAAe,GAAfA,eAAe;IACf,KAAAC,EAAE,GAAFA,EAAE;IAXZ,KAAAC,SAAS,GAAY,KAAK;IAE1B,KAAAC,UAAU,GAAG,IAAI,CAACF,EAAE,CAACG,KAAK,CAAC;MACzBC,KAAK,EAAE,CAAC,IAAI,EAAEX,UAAU,CAACY,OAAO,CAAC,CAACZ,UAAU,CAACa,QAAQ,EAAEb,UAAU,CAACc,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC;KACxF,CAAC;IASA,IAAI,CAACC,WAAW,GAAG,EAAiB;IACpC,IAAI,CAACC,YAAY,GAAG,EAAE;EACxB;EAEAC,MAAMA,CAAA;IACJ,IAAI,CAACT,SAAS,GAAG,IAAI;IACrBU,OAAO,CAACC,GAAG,CAAC,YAAY,EAAE,IAAI,CAACV,UAAU,CAACW,KAAK,CAAC;IAChD,MAAMT,KAAK,GAAG,IAAI,CAACF,UAAU,CAACY,QAAQ,CAAC,OAAO,CAAC,CAACD,KAAK;IAErD,IAAI,CAACT,KAAK,IAAIW,KAAK,CAACC,QAAQ,CAACZ,KAAK,EAAE,EAAE,CAAC,CAAC,EAAE;MACxC,IAAI,CAACK,YAAY,GAAG,oDAAoD;MACxE,IAAI,CAACR,SAAS,GAAG,KAAK;MACtB;;IAGF,IAAI,CAACF,eAAe,CAACkB,gBAAgB,CAACb,KAAK,CAAC,CAACc,SAAS,CAAC;MACrDC,IAAI,EAAGC,QAAa,IAAI;QACtBT,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEQ,QAAQ,CAAC;QAEjC,IAAI,CAACZ,WAAW,GAAGY,QAAQ;QAC3B,IAAI,CAACtB,aAAa,CAACuB,GAAG,CAAC,cAAc,EAAEjB,KAAK,EAAE,CAAC,CAAC;QAChD,IAAI,CAACN,aAAa,CAACuB,GAAG,CAAC,cAAc,EAAE,GAAGD,QAAQ,CAACE,SAAS,IAAIF,QAAQ,CAACG,QAAQ,EAAE,EAAE,CAAC,CAAC;QAEvF,MAAMC,SAAS,GAAG,IAAI,CAAC5B,KAAK,CAAC6B,QAAQ,CAACC,aAAa,CAACC,GAAG,CAAC,WAAW,CAAC,IAAI,GAAG;QAE3E,IAAI,CAAC1B,SAAS,GAAG,KAAK;QAEtB,IAAI,CAACJ,MAAM,CAAC+B,QAAQ,CAAC,CAACJ,SAAS,CAAC,CAAC;MACnC,CAAC;MAEDK,KAAK,EAAGC,GAAG,IAAI;QACb,IAAI,CAAC7B,SAAS,GAAG,KAAK;QAEtB,IAAI6B,GAAG,CAACD,KAAK,CAACE,OAAO,EAAE;UACrB,IAAI,CAACtB,YAAY,GAAGqB,GAAG,CAACD,KAAK,CAACE,OAAO;UACrC;;QAEF,IAAI,CAACtB,YAAY,GAAGqB,GAAG,CAACC,OAAO;MACjC;KACD,CAAC;EACJ;CACD;AAzDYrC,eAAe,GAAAsC,UAAA,EAL3BxC,SAAS,CAAC;EACTyC,QAAQ,EAAE,YAAY;EACtBC,WAAW,EAAE,yBAAyB;EACtCC,SAAS,EAAE,CAAC,wBAAwB;CACrC,CAAC,C,EACWzC,eAAe,CAyD3B"},"metadata":{},"sourceType":"module","externalDependencies":[]}